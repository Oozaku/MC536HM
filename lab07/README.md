## Tarefa de análises feitas no Cypher

## Exercício 1

Calcule o Pagerank do exemplo da Wikipedia em Cypher:

~~~cypher
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/santanche/lab2learn/master/network/pagerank/pagerank-wikipedia.csv' AS line
MERGE (p1:Page {name:line.source})
MERGE (p2:Page {name:line.target})
CREATE (p1)-[:LINKS]->(p2)

CALL gds.graph.create(
  'prGraph',
  'Page',
  'LINKS'
)

CALL gds.pageRank.stream('prGraph')
YIELD nodeId, score
RETURN gds.util.asNode(nodeId).name AS name, score
ORDER BY score DESC, name ASC
~~~

> Coloque aqui a imagem resultante conforme o exemplo (não obrigatório, mas sugerido - imagem produzida pelo CytoScape ou Gephi).



~~~cypher
╒══════╤═══════════════════╕
│"name"│"score"            │
╞══════╪═══════════════════╡
│"B"   │3.422628361545502  │
├──────┼───────────────────┤
│"C"   │3.0444085506722334 │
├──────┼───────────────────┤
│"E"   │0.7503553031226835 │
├──────┼───────────────────┤
│"D"   │0.36260066517154566│
├──────┼───────────────────┤
│"F"   │0.36260066517154566│
├──────┼───────────────────┤
│"A"   │0.3041052853903018 │
├──────┼───────────────────┤
│"G"   │0.15000000000000002│
├──────┼───────────────────┤
│"H"   │0.15000000000000002│
├──────┼───────────────────┤
│"I"   │0.15000000000000002│
├──────┼───────────────────┤
│"J"   │0.15000000000000002│
├──────┼───────────────────┤
│"K"   │0.15000000000000002│
└──────┴───────────────────┘
~~~

## Exercício 2

Departing from a Drug-Drug graph created in a previous lab, whose relationship determines drugs taken together, apply a community detection in it to see the results:

Sem peso!

~~~cypher
CALL gds.graph.create(
  'communitDrugGraph',
  'Drug',
  {
    Relates: {
      orientation: 'UNDIRECTED'
    }
  }
)

CALL gds.louvain.stream('communitDrugGraph')
YIELD nodeId, communityId
RETURN gds.util.asNode(nodeId).code AS code, communityId
ORDER BY communityId ASC
~~~


Levando peso em conta na hora de agrupar

~~~cypher
CALL gds.graph.create(
  'communitWeightedDrug',
  'Drug',
  {
    Relates: {
      orientation: 'UNDIRECTED'
    }
  },
  {
    relationshipProperties: 'weight'
  }
)

CALL gds.louvain.stream('communitWeightedDrug', { relationshipWeightProperty: 'weight' })
YIELD nodeId, communityId
RETURN gds.util.asNode(nodeId).code AS code, communityId
ORDER BY communityId ASC
~~~

> Coloque aqui a imagem resultante conforme o exemplo (não obrigatório, mas sugerido - imagem produzida pelo CytoScape ou Gephi).

Tabela resultante desconsiderando peso: 

~~~cypher

╒══════╤═════════════╕
│"code"│"communityId"│
╞══════╪═════════════╡
│"0"   │0            │
├──────┼─────────────┤
│"4"   │2            │
├──────┼─────────────┤
│"8"   │4            │
├──────┼─────────────┤
│"10"  │5            │
├──────┼─────────────┤
│"11"  │6            │
├──────┼─────────────┤
│"12"  │7            │
├──────┼─────────────┤
│"2"   │9            │
├──────┼─────────────┤
│"13"  │9            │
├──────┼─────────────┤
│"14"  │9            │
├──────┼─────────────┤
│"20"  │9            │
├──────┼─────────────┤
│"31"  │9            │
├──────┼─────────────┤
│"51"  │9            │
├──────┼─────────────┤
│"65"  │9            │
├──────┼─────────────┤
│"68"  │9            │
├──────┼─────────────┤
│"69"  │9            │
├──────┼─────────────┤
│"76"  │9            │
├──────┼─────────────┤
│"80"  │9            │
├──────┼─────────────┤
│"94"  │9            │
├──────┼─────────────┤
│"98"  │9            │
├──────┼─────────────┤
│"119" │9            │
├──────┼─────────────┤
│"123" │9            │
├──────┼─────────────┤
│"125" │9            │
├──────┼─────────────┤
│"129" │9            │
├──────┼─────────────┤
│"131" │9            │
├──────┼─────────────┤
│"133" │9            │
├──────┼─────────────┤
│"144" │9            │
├──────┼─────────────┤
│"147" │9            │
├──────┼─────────────┤
│"162" │9            │
├──────┼─────────────┤
│"165" │9            │
├──────┼─────────────┤
│"172" │9            │
├──────┼─────────────┤
│"191" │9            │
├──────┼─────────────┤
│"200" │9            │
├──────┼─────────────┤
│"222" │9            │
├──────┼─────────────┤
│"239" │9            │
├──────┼─────────────┤
│"248" │9            │
├──────┼─────────────┤
│"268" │9            │
├──────┼─────────────┤
│"349" │9            │
├──────┼─────────────┤
│"367" │9            │
├──────┼─────────────┤
│"399" │9            │
├──────┼─────────────┤
│"418" │9            │
├──────┼─────────────┤
│"493" │9            │
├──────┼─────────────┤
│"510" │9            │
├──────┼─────────────┤
│"519" │9            │
├──────┼─────────────┤
│"520" │9            │
├──────┼─────────────┤
│"558" │9            │
├──────┼─────────────┤
│"620" │9            │
├──────┼─────────────┤
│"773" │9            │
├──────┼─────────────┤
│"877" │9            │
├──────┼─────────────┤
│"921" │9            │
├──────┼─────────────┤
│"979" │9            │
├──────┼─────────────┤
│"1007"│9            │
├──────┼─────────────┤
│"1736"│9            │
├──────┼─────────────┤
...
~~~

Tabela resultante considerando peso:

~~~cypher

╒══════╤═════════════╕
│"code"│"communityId"│
╞══════╪═════════════╡
│"0"   │0            │
├──────┼─────────────┤
│"4"   │2            │
├──────┼─────────────┤
│"8"   │4            │
├──────┼─────────────┤
│"10"  │5            │
├──────┼─────────────┤
│"11"  │6            │
├──────┼─────────────┤
│"12"  │7            │
├──────┼─────────────┤
│"15"  │10           │
├──────┼─────────────┤
│"16"  │11           │
├──────┼─────────────┤
│"17"  │12           │
├──────┼─────────────┤
│"18"  │13           │
├──────┼─────────────┤
│"23"  │15           │
├──────┼─────────────┤
│"24"  │16           │
├──────┼─────────────┤
│"25"  │17           │
├──────┼─────────────┤
│"26"  │18           │
├──────┼─────────────┤
│"27"  │19           │
├──────┼─────────────┤
│"28"  │20           │
├──────┼─────────────┤
│"29"  │21           │
├──────┼─────────────┤
│"30"  │22           │
├──────┼─────────────┤
│"33"  │24           │
├──────┼─────────────┤
│"35"  │25           │
├──────┼─────────────┤
│"36"  │26           │
├──────┼─────────────┤
│"37"  │27           │
├──────┼─────────────┤
│"38"  │28           │
├──────┼─────────────┤
│"39"  │29           │
├──────┼─────────────┤
│"40"  │30           │
├──────┼─────────────┤
│"43"  │31           │
├──────┼─────────────┤
│"44"  │32           │
├──────┼─────────────┤
│"46"  │33           │
├──────┼─────────────┤
│"47"  │34           │
├──────┼─────────────┤
│"6"   │35           │
├──────┼─────────────┤
│"48"  │35           │
├──────┼─────────────┤
│"323" │35           │
├──────┼─────────────┤
│"1616"│35           │
├──────┼─────────────┤
│"49"  │36           │
├──────┼─────────────┤
│"50"  │37           │
├──────┼─────────────┤
│"52"  │39           │
├──────┼─────────────┤
│"53"  │40           │
├──────┼─────────────┤
│"54"  │41           │
├──────┼─────────────┤
│"55"  │42           │
├──────┼─────────────┤
│"56"  │43           │
├──────┼─────────────┤
│"57"  │44           │
├──────┼─────────────┤
│"59"  │45           │
├──────┼─────────────┤
│"60"  │46           │
├──────┼─────────────┤
│"61"  │47           │
├──────┼─────────────┤
│"63"  │48           │
├──────┼─────────────┤
│"64"  │49           │
├──────┼─────────────┤
│"66"  │51           │
├──────┼─────────────┤
│"70"  │54           │
├──────┼─────────────┤
│"71"  │55           │
├──────┼─────────────┤
│"73"  │56           │
├──────┼─────────────┤
│"74"  │57           │
├──────┼─────────────┤
│"75"  │58           │
├──────┼─────────────┤
│"77"  │60           │
├──────┼─────────────┤
│"78"  │61           │
├──────┼─────────────┤
│"79"  │62           │
├──────┼─────────────┤
│"81"  │64           │
├──────┼─────────────┤
│"82"  │65           │
├──────┼─────────────┤
│"83"  │66           │
├──────┼─────────────┤
│"84"  │67           │
├──────┼─────────────┤
│"85"  │68           │
├──────┼─────────────┤
│"86"  │69           │
├──────┼─────────────┤
│"87"  │70           │
├──────┼─────────────┤
│"89"  │71           │
├──────┼─────────────┤
│"90"  │72           │
├──────┼─────────────┤
│"91"  │73           │
├──────┼─────────────┤
│"92"  │74           │
├──────┼─────────────┤
│"95"  │76           │
├──────┼─────────────┤
│"96"  │77           │
├──────┼─────────────┤
│"186" │77           │
├──────┼─────────────┤
│"216" │77           │
├──────┼─────────────┤
│"218" │77           │
├──────┼─────────────┤
│"238" │77           │
├──────┼─────────────┤
│"373" │77           │
├──────┼─────────────┤
│"539" │77           │
├──────┼─────────────┤
│"1096"│77           │
├──────┼─────────────┤
│"1152"│77           │
├──────┼─────────────┤
│"1410"│77           │
├──────┼─────────────┤
│"1729"│77           │
├──────┼─────────────┤
│"1943"│77           │
├──────┼─────────────┤
│"2872"│77           │
├──────┼─────────────┤
...
~~~